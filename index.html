<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>TITAN V.40 PREMIUM</title>
<style>
    /* --- CORE STYLES --- */
    *{margin:0;padding:0;box-sizing:border-box;font-family:-apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Arial, sans-serif; transition:0.3s ease;}    
    body{background:var(--bg);color:var(--text);padding-bottom:80px; -webkit-tap-highlight-color: transparent;}    
    
    /* THEME COLORS */
    :root{
        --bg:#0d0d0d; --text:#fff; --card:#1a1a1a; --border:#333; 
        --green:#00ff6a; --loss:#ff2f2f; --accent:#00ff6a;
    }
    .light{--bg:#f3f3f3;--text:#000;--card:#fff;--border:#ccc;--accent:#000;}
    .blue{--bg:#0a1a3a;--text:#fff;--card:#112955;--border:#1d3a7a;--accent:#4facfe;}
    .red{--bg:#2a0000;--text:#fff;--card:#3d0a0a;--border:#5c0f0f;--accent:#ff2f2f;}
    .purple{--bg:#160020;--text:#fff;--card:#2a0040;--border:#440066;--accent:#d900ff;}
    .green{--bg:#001a0a;--text:#fff;--card:#003d1a;--border:#00662d;--accent:#00ff6a;}
    .gold{--bg:#1a1500;--text:#fff;--card:#3a3000;--border:#6d5b00;--accent:#ffd700;}

    /* HEADER */
    .header{
        padding:15px;text-align:center;font-size:22px;font-weight:900;border-bottom:1px solid var(--border);
        background: var(--card); position: sticky; top: 0; z-index: 100;
        display:flex; justify-content:space-between; align-items:center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .timer-badge{ font-size: 14px; background: var(--border); padding: 5px 12px; border-radius: 50px; font-family: monospace; }

    /* STATS */
    .stats{
        display:flex;justify-content:space-around;padding:15px;background:var(--card);border-bottom:1px solid var(--border);
    }
    .stat-box{text-align:center;font-size:12px;opacity:0.8;}
    .stat-value{font-size:18px;font-weight:bold;margin-top:5px;opacity:1;}
    .win-txt{color:var(--green)!important;}
    .loss-txt{color:var(--loss);}

    /* TERMINAL CARD */
    .pred-card{
        background:var(--card); margin: 20px 15px; padding: 30px; border-radius: 15px;
        border: 1px solid var(--border); text-align: center;
        box-shadow: 0 10px 30px rgba(0,0,0,0.2);
    }
    .big-txt{ 
        font-size: 60px; font-weight: 900; margin: 15px 0; 
        color: var(--accent); text-shadow: 0 0 25px var(--border); 
    }
    .status-badge{ 
        font-size: 11px; font-weight: bold; background: var(--border); color: var(--text);
        padding: 6px 12px; border-radius: 6px; display: inline-block; text-transform: uppercase;
    }
    .seeds-box { margin-top: 20px; border-top: 1px solid var(--border); padding-top: 15px; font-size: 14px; font-weight: bold; color: var(--text); }

    /* ARCHIVE (RESULT CARD STYLE - GREEN/RED GUARD) */
    .archive{padding:0 15px; margin-top: 20px;}
    
    .card{
        background:var(--card); border:1px solid var(--border); padding:15px; 
        border-radius:10px; margin-bottom:12px;
        display:flex; justify-content:space-between; align-items:center;
        /* The "Guard" Effect */
        border-left: 5px solid transparent; 
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    }
    
    /* Guard Colors */
    .guard-win { border-left-color: var(--green); }
    .guard-loss { border-left-color: var(--loss); }

    .card-left { display: flex; flex-direction: column; }
    .period-id { font-size: 13px; opacity: 0.6; font-family: monospace; font-weight: bold; margin-bottom: 4px; }
    .pred-val { font-size: 16px; font-weight: 900; letter-spacing: 0.5px; }
    
    .card-right { text-align: right; }
    .result-val { font-size: 14px; font-weight: bold; margin-bottom: 5px; }

    /* TAG STYLES */
    .tag{padding:5px 10px;border-radius:5px;font-size:12px;font-weight:bold; display: inline-block;}
    .tag.win{background:rgba(0, 255, 106, 0.15); color:var(--green); border: 1px solid var(--green);}
    .tag.loss{background:rgba(255, 47, 47, 0.15); color:var(--loss); border: 1px solid var(--loss);}

    /* NAVIGATION */
    .nav{
        position:fixed;bottom:0;left:0;width:100%;display:flex;background:var(--card);
        border-top:1px solid var(--border); z-index: 999;
        padding-bottom: env(safe-area-inset-bottom);
    }
    .nav button{
        flex:1;padding:12px;border:none;background:none;color:var(--text);font-size:11px;
        display:flex;flex-direction:column;align-items:center; cursor: pointer; opacity: 0.6;
    }
    .nav button.active{opacity: 1; color:var(--accent);}
    .nav-icon { font-size: 20px; margin-bottom: 4px; }

    /* THEME SWITCHER */
    .theme-grid{padding:15px;display:grid;grid-template-columns:repeat(2,1fr);gap:10px;}
    .theme-btn{
        padding:15px;border-radius:8px;text-align:center;border:1px solid var(--border);
        background:var(--card);cursor:pointer; font-weight: bold; font-size: 13px;
    }
    .theme-btn:hover{border-color: var(--text);}

</style>
</head>
<body class="dark">

<div class="header">
    <div id="pageTitle">TITAN V.40</div>
    <div class="timer-badge" id="timer">00:00</div>
</div>

<div id="home" style="display:block;">
    <div class="stats">
        <div class="stat-box">
            <div>Target</div>
            <div class="stat-value" id="pDisp">---</div>
        </div>
        <div class="stat-box">
            <div>Status</div>
            <div class="stat-value win-txt" id="statusShort">ACTIVE</div>
        </div>
    </div>

    <div class="pred-card">
        <div style="font-size: 12px; opacity: 0.6; letter-spacing: 2px;">V.40 TREND-GUARD</div>
        <div class="big-txt" id="mainPred">---</div>
        <div class="status-badge" id="algoStatus">ANALYZING TREND...</div>
        
        <div class="seeds-box">
            2 JACKPOT SEEDS: <span id="seedDisp" style="color:var(--accent)">?, ?</span>
        </div>
    </div>
</div>

<div id="archive" style="display:none;">
    <div class="stats">
        <div class="stat-box">
            <div>Wins</div>
            <div class="stat-value win-txt" id="totalWins">0</div>
        </div>
        <div class="stat-box">
            <div>Losses</div>
            <div class="stat-value loss-txt" id="totalLoss">0</div>
        </div>
        <div class="stat-box">
            <div>Accuracy</div>
            <div class="stat-value win-txt" id="accuracy">100%</div>
        </div>
    </div>
    
    <div class="archive" id="archiveList">
        </div>
</div>

<div class="theme-grid" id="themes" style="display:none;">
    <div class="theme-btn" onclick="setTheme('')">Dark Mode</div>
    <div class="theme-btn" onclick="setTheme('light')">Light Mode</div>
    <div class="theme-btn" onclick="setTheme('blue')">Cyber Blue</div>
    <div class="theme-btn" onclick="setTheme('red')">Red Alert</div>
    <div class="theme-btn" onclick="setTheme('purple')">Neon Purple</div>
    <div class="theme-btn" onclick="setTheme('green')">Matrix Green</div>
    <div class="theme-btn" onclick="setTheme('gold')">Royal Gold</div>
</div>

<div class="nav">
    <button class="active" onclick="showSection('home', this)">
        <span class="nav-icon">âš¡</span>Home
    </button>
    <button onclick="showSection('archive', this)">
        <span class="nav-icon">ðŸ“œ</span>Archive
    </button>
    <button onclick="showSection('themes', this)">
        <span class="nav-icon">ðŸŽ¨</span>Themes
    </button>
</div>

<script>
    // --- UI CONTROLLER ---
    function showSection(sec, btn){
        document.getElementById('home').style.display='none';
        document.getElementById('archive').style.display='none';
        document.getElementById('themes').style.display='none';
        
        document.getElementById(sec).style.display='block';
        if(sec === 'themes') document.getElementById(sec).style.display='grid';

        document.querySelectorAll('.nav button').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        const titles = {'home': 'TITAN V.40', 'archive': 'ARCHIVE LOG', 'themes': 'VISUALS'};
        document.getElementById('pageTitle').innerText = titles[sec];
    }

    function setTheme(theme){ document.body.className = theme; }

    // --- TITAN V.40 LOGIC (TREND-GUARD) ---
    const API = "https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json";
    let lastP = ""; 
    let log = [];
    let isSyncing = false;

    // Timer
    setInterval(() => {
        const s = new Date().getSeconds();
        const rem = 60 - s;
        document.getElementById('timer').innerText = `00:${rem < 10 ? '0' : ''}${rem}`;
        if(s === 1 || s % 3 === 0) titanSync();
    }, 1000);

    async function titanSync() {
        if(isSyncing) return;
        isSyncing = true;
        try {
            await new Promise(r => setTimeout(r, Math.random() * 300));
            const r = await fetch(`${API}?pageSize=20&ts=${Date.now()}`);
            const d = await r.json();
            const list = d.data.list;
            const currentP = list[0].issueNumber;

            // 1. Result Update
            if (log.length > 0 && log[0].period === currentP) {
                const actNum = parseInt(list[0].number);
                const actBS = actNum >= 5 ? "BIG" : "SMALL";
                log[0].res = (actBS === log[0].pred) ? "WIN" : "LOSS";
                log[0].num = actNum;
                updateArchiveUI();
                updateStatsUI();
            }

            // 2. New Prediction
            if (currentP !== lastP) {
                lastP = currentP;
                const nextP = (BigInt(currentP) + 1n).toString();
                document.getElementById('pDisp').innerText = nextP;
                
                runTitanLogic(list, nextP);
            }
        } catch (e) { console.log(e); }
        isSyncing = false;
    }

    function runTitanLogic(list, nextP) {
        const nums = list.map(x => parseInt(x.number));
        const bs = nums.map(n => n >= 5 ? "BIG" : "SMALL");
        let p = "";
        let status = "";
        let seeds = [];

        // --- TREND-GUARD LOGIC ---
        // History Analysis
        let lastOne = bs[0];
        let prevOne = bs[1];
        let isDragon = (lastOne === prevOne); 
        
        // Count Streak of Losses
        let lossCount = 0;
        for(let i=0; i<log.length; i++) {
            if(log[i].res === "LOSS") lossCount++; else break;
        }

        // --- DECISION MAKING ---
        if (lossCount >= 1) {
            // === LEVEL 2: RECOVERY ===
            // Agar ek baar loss ho gaya, matlab hamara prediction galat tha.
            // Ab hum "Check" karenge ke kya trend change ho gaya?
            
            if (isDragon) {
                // Agar pichle 2 result same hain (B-B ya S-S), toh DRAGON hai.
                // Dragon ke khilaf mat jao. FOLLOW karo.
                p = lastOne; 
                status = "ðŸ›¡ï¸ TREND-GUARD: FOLLOW";
            } else {
                // Agar pichle 2 result alag hain (B-S), toh ZIG-ZAG hai.
                // Last result ko FLIP karo.
                p = (lastOne === "BIG") ? "SMALL" : "BIG";
                status = "âš¡ ZIG-ZAG MODE";
            }
        } else {
            // === LEVEL 1: NORMAL NEURAL ===
            // Jab sab sahi chal raha ho
            let sum = nums[0] + nums[1];
            p = (sum % 2 === 0) ? lastOne : (lastOne==="BIG"?"SMALL":"BIG");
            status = "âœ… NEURAL SCAN";
        }

        // Seeds
        if (p === "BIG") seeds = [7, 9]; else seeds = [0, 2];

        // UI Update
        const mainPred = document.getElementById('mainPred');
        mainPred.innerText = p;
        mainPred.style.color = p === "BIG" ? "var(--accent)" : "var(--text)";
        
        document.getElementById('algoStatus').innerText = status;
        document.getElementById('seedDisp').innerText = seeds.join(", ");

        log.unshift({ period: nextP, pred: p, res: "WAIT", num: "?", seeds: seeds });
    }

    function updateArchiveUI() {
        const div = document.getElementById('archiveList');
        div.innerHTML = log.slice(0, 20).map(h => {
            const isWin = h.res === 'WIN';
            const guardClass = isWin ? 'guard-win' : 'guard-loss';
            const tagClass = isWin ? 'tag win' : 'tag loss';
            
            let numDisp = h.num;
            let resText = "WAITING";
            if(h.res !== "WAIT") {
                resText = `RESULT: ${h.res === 'WIN' ? h.pred : (h.pred==='BIG'?'SMALL':'BIG')}`;
            }

            return `
            <div class="card ${guardClass}">
                <div class="card-left">
                    <span class="period-id">Prediction #${h.period.slice(-4)}</span>
                    <span class="pred-val" style="color:${h.pred==='BIG'?'var(--accent)':'var(--text)'}">${h.pred}</span>
                </div>
                <div class="card-right">
                    <div class="result-val">${resText} (${numDisp})</div>
                    <span class="${tagClass}">${h.res}</span>
                </div>
            </div>`;
        }).join('');
    }

    function updateStatsUI() {
        const wins = log.filter(x => x.res === 'WIN').length;
        const losses = log.filter(x => x.res === 'LOSS').length;
        const total = wins + losses;
        const acc = total === 0 ? 0 : Math.round((wins / total) * 100);

        document.getElementById('totalWins').innerText = wins;
        document.getElementById('totalLoss').innerText = losses;
        document.getElementById('accuracy').innerText = acc + "%";
    }

    titanSync();
</script>
</body>
</html>
