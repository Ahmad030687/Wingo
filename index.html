<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>AHMAD PRO V.45</title>
<script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.9.2/dist/confetti.browser.min.js"></script>
<style>
    /* --- PROFESSIONAL DASHBOARD THEME --- */
    *{box-sizing:border-box;margin:0;padding:0;user-select:none;-webkit-tap-highlight-color:transparent;}
    :root{ 
        --bg: #050505; 
        --card: #121212;
        --cyan: #00f2ff; 
        --gold: #ffc107; 
        --green: #00e676; 
        --red: #ff3d00;
        --text: #ffffff;
        --text-muted: #888888;
        --border: #222222;
    }
    
    body{ 
        background-color: var(--bg); 
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; 
        color: var(--text); min-height: 100vh; overflow-x: hidden;
    }
    
    .app{ max-width:420px; margin:auto; padding:15px; padding-bottom: 90px; }

    /* HEADER */
    .header{ 
        display: flex; justify-content: space-between; align-items: center;
        padding: 10px 5px; margin-bottom: 20px; border-bottom: 1px solid var(--border);
    }
    .brand{ font-size: 18px; font-weight: 800; letter-spacing: 1px; color: var(--cyan); }
    .timer-pill{ 
        background: #000; border: 1px solid var(--border); color: var(--cyan);
        padding: 4px 12px; border-radius: 4px; font-family: monospace; font-size: 16px;
    }

    /* PREDICTION CARD */
    .pro-card {
        background: var(--card); border: 1px solid var(--border);
        border-radius: 12px; padding: 25px; margin-bottom: 20px;
        text-align: center; position: relative; overflow: hidden;
        box-shadow: 0 4px 20px rgba(0,0,0,0.5);
    }
    .pro-card::before {
        content:''; position:absolute; top:0; left:0; width:100%; height:3px;
        background: linear-gradient(90deg, transparent, var(--cyan), transparent);
        animation: scan 2s infinite linear;
    }
    @keyframes scan { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }

    .card-title { font-size: 10px; color: var(--text-muted); text-transform: uppercase; letter-spacing: 2px; }
    .pred-text { 
        font-size: 56px; font-weight: 900; margin: 10px 0; 
        background: linear-gradient(180deg, #fff, #888); 
        -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .logic-tag { 
        font-size: 11px; color: var(--gold); background: rgba(255, 193, 7, 0.1);
        padding: 4px 8px; border-radius: 4px; display: inline-block; border: 1px solid rgba(255, 193, 7, 0.2);
    }

    /* --- PROFESSIONAL STATS DASHBOARD --- */
    .dashboard-grid {
        display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px;
    }
    .dash-box {
        background: var(--card); border: 1px solid var(--border);
        border-radius: 8px; padding: 12px; text-align: center;
    }
    .dash-val { font-size: 20px; font-weight: 800; }
    .dash-lbl { font-size: 9px; color: var(--text-muted); text-transform: uppercase; margin-top: 4px; }
    
    .win-text { color: var(--green); }
    .loss-text { color: var(--red); }
    .acc-text { color: var(--gold); }

    /* HISTORY LIST */
    .history-label { font-size: 12px; font-weight: 700; color: var(--text-muted); margin-bottom: 10px; }
    .history-item {
        display: flex; justify-content: space-between; align-items: center;
        background: var(--card); border-bottom: 1px solid var(--border);
        padding: 15px; margin-bottom: 6px; border-radius: 8px;
    }
    .hist-left { display: flex; flex-direction: column; }
    .hist-period { font-size: 12px; color: var(--text-muted); font-family: monospace; }
    .hist-logic { font-size: 10px; color: var(--cyan); }
    
    .hist-right { display: flex; align-items: center; gap: 10px; }
    .hist-res { font-size: 16px; font-weight: 700; color: #fff; }
    .status-badge {
        font-size: 10px; font-weight: 800; padding: 2px 6px; border-radius: 3px;
        min-width: 40px; text-align: center;
    }
    .badge-win { background: rgba(0, 230, 118, 0.2); color: var(--green); border: 1px solid var(--green); }
    .badge-loss { background: rgba(255, 61, 0, 0.2); color: var(--red); border: 1px solid var(--red); }

    /* RESET BUTTON */
    .reset-btn {
        width: 100%; padding: 12px; background: #111; color: #555;
        border: 1px solid var(--border); border-radius: 8px;
        font-size: 11px; font-weight: bold; margin-top: 20px; cursor: pointer;
    }
</style>
</head>
<body>

<div class="app">
    
    <div class="header">
        <div class="brand">AHMAD PRO V.45</div>
        <div class="timer-pill" id="timer">00</div>
    </div>

    <div class="pro-card">
        <div class="card-title">NEXT PERIOD: <span id="nextP" style="color:#fff">...</span></div>
        <div class="pred-text" id="pred">WAIT</div>
        <div class="logic-tag" id="logic">ANALYZING MARKET DATA...</div>
        <div style="margin-top:10px; font-size:10px; color:#555;" id="lvl">LEVEL 1</div>
    </div>

    <div class="dashboard-grid">
        <div class="dash-box">
            <div class="dash-val win-text" id="totalWins">0</div>
            <div class="dash-lbl">Total Wins</div>
        </div>
        <div class="dash-box">
            <div class="dash-val loss-text" id="totalLoss">0</div>
            <div class="dash-lbl">Total Losses</div>
        </div>
        <div class="dash-box">
            <div class="dash-val acc-text" id="accuracy">0%</div>
            <div class="dash-lbl">Accuracy</div>
        </div>
    </div>

    <div class="history-label">SESSION HISTORY</div>
    <div id="list"></div>

    <button class="reset-btn" onclick="resetStats()">RESET SESSION STATS</button>
</div>

<script>
    const API = "https://draw.ar-lottery01.com/WinGo/WinGo_30S/GetHistoryIssuePage.json?ts=";
    
    // --- SESSION STATE ---
    let sessionWins = 0;
    let sessionLosses = 0;
    let currentLevel = 1;
    let lastIssue = "";
    let currentPred = null;

    // --- TIMERS ---
    setInterval(updateTimer, 1000);
    setInterval(fetchData, 1000);

    function updateTimer() {
        const d = new Date();
        const s = d.getSeconds();
        const remaining = s < 30 ? 30 - s : 60 - s;
        const el = document.getElementById('timer');
        el.innerText = remaining < 10 ? `0${remaining}` : remaining;
        
        if (remaining <= 5) el.style.color = "var(--red)";
        else el.style.color = "var(--cyan)";
    }

    async function fetchData() {
        try {
            const res = await fetch(API + Date.now());
            const data = await res.json();
            const list = data.data.list;
            const latest = list[0].issueNumber;

            if (latest !== lastIssue) {
                if (currentPred && lastIssue !== "") processResult(list[0], currentPred);
                lastIssue = latest;
                predict(list);
            }
        } catch (e) { console.log("Sync..."); }
    }

    // --- ENHANCED LOGIC ENGINE V.45 ---
    function predict(history) {
        const lastNum = parseInt(history[0].number);
        const lastBS = lastNum >= 5 ? "BIG" : "SMALL";
        const prevBS = history[1].number >= 5 ? "BIG" : "SMALL";
        const pPrevBS = history[2].number >= 5 ? "BIG" : "SMALL";
        
        let prediction = "";
        let logic = "";
        let nextP = (BigInt(history[0].issueNumber) + 1n).toString();

        // PATTERN ANALYSIS
        let streak = 1;
        if (lastBS === prevBS) streak = 2;
        if (streak === 2 && prevBS === pPrevBS) streak = 3;

        // --- LEVEL 2: SAFETY NET (STICKY) ---
        if (currentLevel === 2) {
            if (lastNum === 0 || lastNum === 5) {
                prediction = "SMALL"; 
                logic = "L2: TRAP GUARD";
            } else {
                // If L1 failed, Trend likely started. Stick to it.
                prediction = lastBS; 
                logic = "L2: PRO RECOVERY";
            }
        }
        // --- LEVEL 1: ACCURACY MODE ---
        else {
            if (streak >= 3) {
                // Strong Dragon -> Ride it
                prediction = lastBS;
                logic = "L1: DRAGON MASTER";
            } else if (lastBS === prevBS) {
                // 2 Streak -> Assume Stickiness
                prediction = lastBS;
                logic = "L1: STICKY TREND";
            } else {
                // Zig-Zag (Flip)
                prediction = lastBS === "BIG" ? "SMALL" : "BIG";
                logic = "L1: FLIP DETECT";
            }
        }

        currentPred = { pick: prediction, logic: logic };
        
        // UI Update
        document.getElementById('nextP').innerText = nextP.slice(-5);
        document.getElementById('pred').innerText = prediction;
        document.getElementById('logic').innerText = logic;
        
        // Color Coding
        const pEl = document.getElementById('pred');
        if (prediction === 'BIG') {
            pEl.style.background = "linear-gradient(180deg, #fff, #00f2ff)";
            pEl.style.webkitBackgroundClip = "text"; 
            pEl.style.webkitTextFillColor = "transparent";
        } else {
            pEl.style.background = "linear-gradient(180deg, #fff, #ffc107)";
            pEl.style.webkitBackgroundClip = "text"; 
            pEl.style.webkitTextFillColor = "transparent";
        }
        
        document.getElementById('lvl').innerText = currentLevel === 1 ? "LEVEL 1 (SAFE)" : "LEVEL 2 (RECOVERY)";
        document.getElementById('lvl').style.color = currentLevel === 1 ? "var(--green)" : "var(--gold)";
    }

    function processResult(actual, pred) {
        const actualBS = actual.number >= 5 ? "BIG" : "SMALL";
        const won = actualBS === pred.pick;

        if (won) {
            sessionWins++;
            currentLevel = 1;
            triggerConfetti();
        } else {
            sessionLosses++;
            currentLevel = 2; // Level 2 Logic activates next
        }

        updateStatsUI();
        addToHistory(actual, pred, won, actualBS);
    }

    function updateStatsUI() {
        document.getElementById('totalWins').innerText = sessionWins;
        document.getElementById('totalLoss').innerText = sessionLosses;
        
        const total = sessionWins + sessionLosses;
        const acc = total === 0 ? 0 : Math.round((sessionWins / total) * 100);
        document.getElementById('accuracy').innerText = acc + "%";
    }

    function addToHistory(data, pred, won, actualResult) {
        const list = document.getElementById('list');
        const item = document.createElement('div');
        item.className = 'history-item';
        
        item.innerHTML = `
            <div class="hist-left">
                <span class="hist-period">Period #${data.issueNumber.slice(-5)}</span>
                <span class="hist-logic">${pred.logic}</span>
            </div>
            <div class="hist-right">
                <span class="hist-res">${actualResult}</span>
                <div class="status-badge ${won ? 'badge-win' : 'badge-loss'}">
                    ${won ? 'WIN' : 'LOSS'}
                </div>
            </div>
        `;
        list.prepend(item);
    }

    function resetStats() {
        sessionWins = 0;
        sessionLosses = 0;
        updateStatsUI();
        document.getElementById('list').innerHTML = "";
    }

    function triggerConfetti() {
        const colors = ['#00e676', '#00f2ff', '#ffffff'];
        confetti({ particleCount: 150, spread: 80, origin: { y: 0.6 }, colors: colors });
    }
</script>
</body>
</html>
