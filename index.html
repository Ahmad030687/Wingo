<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>COMMANDER SUPREME | 10-ROUND SNIPER</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@900&family=Rajdhani:wght@700&display=swap" rel="stylesheet">

<style>
:root { --primary: #00ff9c; --red: #ff3e3e; --bg: #050505; --card: #0d0d0d; }
* { margin:0; padding:0; box-sizing:border-box; font-family: 'Rajdhani', sans-serif; }
body { background: var(--bg); color: #fff; text-align: center; padding-bottom: 100px; overflow-x: hidden; }

header { padding: 20px; background: #000; border-bottom: 2px solid var(--primary); font-family: 'Orbitron'; font-weight: 900; box-shadow: 0 0 25px rgba(0,255,156,0.2); font-size: 20px; text-transform: uppercase; }

/* LIVE SCAN BAR */
.scan-line { width: 100%; height: 4px; background: #111; position: relative; overflow: hidden; }
.scan-bar { height: 100%; width: 50%; background: var(--primary); position: absolute; animation: fastScan 1s linear infinite; box-shadow: 0 0 15px var(--primary); }
@keyframes fastScan { 0% { left: -50%; } 100% { left: 100%; } }

.commander-box {
    margin: 20px; padding: 45px 15px; border-radius: 25px;
    background: radial-gradient(circle at center, #151515, #000);
    border: 1px solid rgba(0,255,156,0.4); position: relative;
    box-shadow: 0 0 40px rgba(0,0,0,1);
}
.timer-chip { position: absolute; top: 15px; right: 20px; background: #000; border: 1px solid #fff; padding: 2px 10px; border-radius: 8px; font-weight: 900; font-family: 'Orbitron'; font-size: 18px; }

.signal-type { font-size: 11px; color: var(--primary); letter-spacing: 4px; font-weight: bold; margin-bottom: 10px; text-transform: uppercase; }
.signal-main { font-family: 'Orbitron'; font-size: 70px; font-weight: 900; margin: 10px 0; text-transform: uppercase; line-height: 1; transition: 0.3s; }
.signal-main.BIG, .signal-main.GREEN { color: var(--primary); text-shadow: 0 0 40px var(--primary); }
.signal-main.SMALL, .signal-main.RED { color: var(--red); text-shadow: 0 0 40px var(--red); }

.stage-badge { display: inline-block; background: #222; padding: 8px 25px; border-radius: 50px; font-size: 16px; font-weight: 900; color: #fff; border: 2px solid #444; margin-bottom: 20px; letter-spacing: 2px; }
.stage-badge.HIT { background: #ff9800; border-color: #fff; animation: glow 1s infinite; }

.jackpot-row { display: flex; justify-content: center; align-items: center; gap: 15px; margin-top: 15px; padding-top: 15px; border-top: 1px solid #222; }
.ball { width: 35px; height: 35px; border-radius: 50%; background: #fff; color: #000; line-height: 35px; font-weight: 900; font-family: 'Orbitron'; box-shadow: 0 0 15px #fff; }

.h-card { background: var(--card); padding: 18px; border-radius: 15px; margin: 10px 15px; display: flex; justify-content: space-between; align-items: center; border-left: 6px solid #333; }
.h-card.win { border-left-color: var(--primary); background: linear-gradient(90deg, rgba(0,255,156,0.1), transparent); }
.h-card.loss { border-left-color: var(--red); background: linear-gradient(90deg, rgba(255,62,62,0.1), transparent); }

nav { position: fixed; bottom: 0; width: 100%; background: #000; border-top: 2px solid #333; display: flex; justify-content: space-around; padding: 25px 0; z-index: 1000; }
nav i { font-size: 26px; color: #444; }
nav i.active { color: var(--primary); text-shadow: 0 0 15px var(--primary); }

@keyframes glow { 50% { box-shadow: 0 0 20px #ff9800; opacity: 0.8; } }
</style>
</head>
<body>

<header>COMMANDER 10-ROUND SNIPER</header>
<div class="scan-line"><div class="scan-bar"></div></div>

<div class="commander-box">
    <div class="timer-chip" id="timer">00</div>
    <div style="font-size: 11px; color: #555; margin-bottom: 5px;">API SYNCED PERIOD: <span id="period">----</span></div>
    
    <div class="signal-type" id="sig-mode">SCANNING 10-ROUND CONTEXT...</div>
    <div class="signal-main" id="prediction">SYNCING</div>
    
    <div class="stage-badge" id="stage-info">STAGE 1</div>
    
    <div class="jackpot-row">
        <span style="font-size: 10px; font-weight: 900; color: #888;">AI SEEDS</span>
        <div class="ball" id="n1">-</div>
        <div class="ball" id="n2">-</div>
    </div>
</div>

<div style="display: flex; justify-content: space-between; margin: 0 20px 15px; font-weight: 900; font-size: 14px;">
    <span style="color:var(--primary)">WINS: <span id="w-count">0</span></span>
    <span style="color:var(--red)">LOSS: <span id="l-count">0</span></span>
</div>

<div id="history-box"></div>

<nav>
    <i class="fa-solid fa-bolt-lightning active"></i>
    <i class="fa-solid fa-rotate" onclick="location.reload()"></i>
    <i class="fa-solid fa-trash" onclick="localStorage.clear(); location.reload();"></i>
</nav>

<script>
    const firebaseConfig = { apiKey: "AIzaSyA8qJ3qJl5fzbOBKopx99zsACkEGofbfyY", authDomain: "admin-91a73.firebaseapp.com", databaseURL: "https://admin-91a73-default-rtdb.firebaseio.com", projectId: "admin-91a73", storageBucket: "admin-91a73.firebasestorage.app", messagingSenderId: "153529788738", appId: "1:153529788738:web:65363636579881912940db", measurementId: "G-N4T0HV7ER1" };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    let history = JSON.parse(localStorage.getItem('sniper_hist')) || [];
    let stats = JSON.parse(localStorage.getItem('sniper_stats')) || { w:0, l:0 };
    let lossStreak = parseInt(localStorage.getItem('sniper_streak')) || 0;
    let lastProcessed = null;

    function save() {
        localStorage.setItem('sniper_hist', JSON.stringify(history));
        localStorage.setItem('sniper_stats', JSON.stringify(stats));
        localStorage.setItem('sniper_streak', lossStreak);
    }

    async function engine() {
        try {
            const res = await fetch("https://draw.ar-lottery01.com/WinGo/WinGo_1M/GetHistoryIssuePage.json?pageSize=10&ts="+Date.now());
            const json = await res.json();
            const list = json.data.list;
            const latest = list[0];
            const issue = latest.issueNumber;
            const num = parseInt(latest.number);
            const size = num >= 5 ? 'BIG' : 'SMALL';
            const color = [1,3,7,9].includes(num) ? 'GREEN' : (num === 5 ? 'GREEN' : 'RED');

            if (history.length > 0 && history[0].status === 'pending' && history[0].issue === issue) {
                let win = history[0].type === 'SIZE' ? (history[0].pred === size) : (history[0].pred === color);
                if(win) { history[0].status = 'win'; stats.w++; lossStreak = 0; }
                else { history[0].status = 'loss'; stats.l++; lossStreak++; }
                history[0].res = `${num} (${size.charAt(0)})`;
                save(); render();
            }

            if (lastProcessed !== issue) {
                lastProcessed = issue;
                const nextIssue = (BigInt(issue)+1n).toString();
                
                // --- 10-ROUND SMART LOGIC ---
                let sConcentration = 0; 
                let cConcentration = 0;
                
                // Count trends in exactly 10 rounds
                for(let i=0; i<list.length; i++) {
                    if((parseInt(list[i].number) >= 5 ? 'BIG':'SMALL') === size) sConcentration++;
                    let col = [1,3,7,9].includes(parseInt(list[i].number)) ? 'GREEN' : 'RED';
                    if(col === color) cConcentration++;
                }

                let finalPred = ""; let finalType = "";
                
                // If losing, apply Anti-Chop to break the cycle
                if (lossStreak >= 1) {
                    finalPred = (sConcentration > 5) ? (size === 'BIG' ? 'SMALL' : 'BIG') : size;
                    finalType = 'SIZE';
                } else {
                    // Stage 1 Selection based on Concentration
                    if (cConcentration >= sConcentration) { finalPred = color; finalType = 'COLOR'; }
                    else { finalPred = size; finalType = 'SIZE'; }
                }

                history.unshift({ issue: nextIssue, pred: finalPred, type: finalType, status: 'pending' });
                if(history.length > 20) history.pop();
                
                updateUI(finalPred, finalType, nextIssue, num);
                save(); render();
            }
        } catch(e) {}
    }

    function updateUI(pred, type, issue, lastNum) {
        const pEl = document.getElementById('prediction');
        const stEl = document.getElementById('stage-info');
        document.getElementById('period').innerText = issue.slice(-5);
        pEl.innerText = pred;
        pEl.className = "signal-main " + pred;
        document.getElementById('sig-mode').innerText = "10-ROUND " + type + " CONTEXT HIT";

        if(lossStreak === 0) { stEl.innerText = "STAGE 1"; stEl.className = "stage-badge"; }
        else { stEl.innerText = `STAGE ${lossStreak + 1} RECOVERY`; stEl.className = "stage-badge HIT"; }

        document.getElementById('n1').innerText = (lastNum + 5) % 10;
        document.getElementById('n2').innerText = (lastNum + 1) % 10;
    }

    function render() {
        document.getElementById('w-count').innerText = stats.w;
        document.getElementById('l-count').innerText = stats.l;
        document.getElementById('history-box').innerHTML = history.map(h => {
            if(h.status === 'pending') return '';
            const clr = h.status === 'win' ? 'var(--primary)' : 'var(--red)';
            return `
                <div class="h-card ${h.status}">
                    <div style="text-align:left">
                        <div style="font-size:10px; color:#555">#${h.issue.slice(-5)}</div>
                        <div style="font-weight:900; color:${clr}">${h.pred}</div>
                    </div>
                    <div style="font-weight:900;">${h.res || '?'}</div>
                </div>`;
        }).join('');
    }

    setInterval(() => {
        const s = 60 - new Date().getSeconds();
        document.getElementById('timer').innerText = s.toString().padStart(2, '0');
        if(s === 1 || s === 59) engine();
    }, 1000);
    engine(); render();
</script>
</body>
</html>
